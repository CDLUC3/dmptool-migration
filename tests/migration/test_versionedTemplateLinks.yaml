test_template_links:
  model: migration.versioned_template_links

  vars:
    super_admin_id: 999

  # -- Input data simulating source tables and variables
  inputs:
    migration.versioned_templates:
      columns:
        id: INT
        old_template_id: INT
        createdById: INT
        created: DATETIME
        modifiedById: INT
        modified: DATETIME
      rows:
        - id: 4
          old_template_id: 10
          createdById: 999
          created: '2024-01-02 11:00:00'
          modifiedById: 999
          modified: '2024-01-02 11:00:00'

        - id: 5
          old_template_id: 11
          createdById: 999
          created: '2024-01-06 11:00:00'
          modifiedById: 999
          modified: '2024-01-06 11:00:00'

        - id: 6
          old_template_id: 12
          createdById: 999
          created: '2024-01-06 11:00:00'
          modifiedById: 999
          modified: '2024-01-06 11:00:00'

    intermediate.template_links:
      columns:
        id: INT
        old_template_id: INT
        linkType: VARCHAR
        url: VARCHAR
        text: VARCHAR
        createdById: INT
        created: DATETIME
      rows:
        - id: 1
          old_template_id: 10
          linkType: 'FUNDER'
          url: 'https://dot.gov/plan1'
          text: 'DOT Plan'
          createdById: 999
          created: '2024-01-01 10:00:00'

        - id: 2
          old_template_id: 10
          linkType: 'SAMPLE_PLAN'
          url: 'https://ntl.bts.gov/sample1'
          text: 'Sample Plan'
          createdById: 999
          created: '2024-01-01 10:00:00'

        - id: 3
          old_template_id: 11
          linkType: 'FUNDER'
          url: 'https://dot.gov/plan2'
          text: 'DOT Plan 2'
          createdById: 999
          created: '2024-01-05 10:00:00'

        - id: 4
          old_template_id: 12
          linkType: 'SAMPLE'
          url: 'https://sample.only'
          text: 'Only Sample'
          createdById: 999
          created: '2024-01-10 09:00:00'

  # -- Expected output data
  outputs:
    query:
      rows:
        # Record from template 1 (FUNDER link)
        - id: 1
          versionedTemplateId: 4
          linkType: 'FUNDER'
          url: 'https://dot.gov/plan1'
          text: 'DOT Plan'
          createdById: 999
          created: '2024-01-02 11:00:00'
          modifiedById: 999
          modified: '2024-01-02 11:00:00'
        # Record from template 1 (SAMPLE link)
        - id: 2
          versionedTemplateId: 4
          linkType: 'SAMPLE_PLAN'
          url: 'https://ntl.bts.gov/sample1'
          text: 'Sample Plan'
          createdById: 999
          created: '2024-01-02 11:00:00'
          modifiedById: 999
          modified: '2024-01-02 11:00:00'
        # Record from template 2 (FUNDER only)
        - id: 3
          versionedTemplateId: 5
          linkType: 'FUNDER'
          url: 'https://dot.gov/plan2'
          text: 'DOT Plan 2'
          createdById: 999
          created: '2024-01-06 11:00:00'
          modifiedById: 999
          modified: '2024-01-06 11:00:00'
        # Record from template 3 (SAMPLE only)
        - id: 4
          versionedTemplateId: 6
          linkType: 'SAMPLE'
          url: 'https://sample.only'
          text: 'Only Sample'
          createdById: 999
          created: '2024-01-06 11:00:00'
          modifiedById: 999
          modified: '2024-01-06 11:00:00'
