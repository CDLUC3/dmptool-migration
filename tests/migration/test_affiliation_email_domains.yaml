test_affiliation_email_domains:
  model: migration.affiliation_email_domains
  vars:
    execution_time: "2025-10-01 00:00:00+00:00"

  inputs:
    dmp.orgs:
      rows:
        - id: 1
          target_url: NULL
          created_at: "2020-01-01 00:00:00"
          updated_at: "2020-02-01 00:00:00"
        - id: 2
          target_url: ""
          created_at: "2021-01-01 00:00:00"
          updated_at: "2021-02-01 00:00:00"
        - id: 4
          target_url: "http://example.org/services/test"
          created_at: "2022-01-01 00:00:00"
          updated_at: "2022-02-01 00:00:00"
        - id: 5
          target_url: "http://www.example.com/"
          created_at: "2023-01-01 00:00:00"
          updated_at: "2023-02-01 00:00:00"
        - id: 10
          target_url: "https://www.library.example.gov/"
          created_at: "2024-01-01 00:00:00"
          updated_at: "2024-02-01 00:00:00"

    dmp.registry_orgs:
      - id: 50
        org_id: 4
        ror_id: "https://ror.org/abc123"

  outputs:
    query:
      rows:
        - id: 1
          affiliationId: "https://ror.org/abc123"
          emailDomain: "example.org"
          createdById: 1
          created: "2022-01-01 00:00:00"
          modifiedById: 1
          modified: "2022-02-01 00:00:00"
        - id: 2
          affiliationId: "https://dmptool.org/affiliations/5"
          emailDomain: "example.com"
          createdById: 1
          created: "2023-01-01 00:00:00"
          modifiedById: 1
          modified: "2023-02-01 00:00:00"
        - id: 3
          affiliationId: "https://dmptool.org/affiliations/10"
          emailDomain: "library.example.gov"
          createdById: 1
          created: "2024-01-01 00:00:00"
          modifiedById: 1
          modified: "2024-02-01 00:00:00"
