test_project_members:
  model: intermediate.project_members
  vars:
    execution_time: "2025-10-01 00:00:00"

  inputs:
    intermediate.plans:
      rows:
        - id: 1
          owner_email: "owner1@example.com"
        - id: 2
          owner_email: "owner2@example.com"

    intermediate.users:
      rows:
        - id: 1
          org_id: "https://dmptool.org/affiliations/0"
          firstname: "Given"
          surname: "Surname"
          email: "owner1@example.com"
          orcid: "https://orcid.org/0000-0000-0000-0001"
          created_at: "2024-01-01 00:00:00"
          updated_at: "2024-01-02 00:00:00"
        - id: 2
          org_id: "https://ror.org/123abc"
          firstname: "First"
          surname: "Last"
          email: "owner2@example.com"
          orcid: NULL
          created_at: "2025-01-01 00:00:00"
          updated_at: "2025-01-02 00:00:00"

    intermediate.contributors:
      rows:
        - id: 1
          plan_id: 2
          email: "author2@example.com"
          orcid: "https://orcid.org/0000-0000-0000-0003"
          roles: 1
          created_at: "2025-01-01 00:00:00"
          updated_at: "2025-01-02 00:00:00"
          first_name: "Captain"
          last_name: "Nemo"
          affiliation_id: "https://ror.org/123abcd"

  outputs:
    columns:
      oldRoleId: INT

    query:
      rows:
        - id: 1
          userId: 1
          oldRoleId: NULL
          memberRoleId: 15
          projectId: 1
          affiliationId: "https://dmptool.org/affiliations/0"
          givenName: "Given"
          surName: "Surname"
          orcid: "https://orcid.org/0000-0000-0000-0001"
          email: "owner1@example.com"
          isPrimaryContact: 1
          createdById: 1
          created: "2024-01-01 00:00:00"
          modifiedById: 1
          modified: "2024-01-02 00:00:00"

        - id: 2
          userId: 2
          oldRoleId: NULL
          memberRoleId: 15
          projectId: 2
          affiliationId: "https://ror.org/123abc"
          givenName: "First"
          surName: "Last"
          orcid: NULL
          email: "owner2@example.com"
          isPrimaryContact: 1
          createdById: 2
          created: "2025-01-01 00:00:00"
          modifiedById: 2
          modified: "2025-01-02 00:00:00"

        - id: 3
          userId: NULL
          oldRoleId: 1
          memberRoleId: NULL
          projectId: 2
          affiliationId: "https://ror.org/123abcd"
          givenName: "Captain"
          surName: "Nemo"
          orcid: "https://orcid.org/0000-0000-0000-0003"
          email: "author2@example.com"
          isPrimaryContact: 0
          createdById: 2
          created: "2025-01-01 00:00:00"
          modifiedById: 2
          modified: "2025-01-02 00:00:00"
